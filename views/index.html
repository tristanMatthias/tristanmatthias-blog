<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tristan Matthias</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css"/>
</head>
<body>

    <header>
        <nav>
            <ul>
                <li class="logo"><a href="#home"><img src="images/logo.svg" alt="Tristan Matthias"></a></li>
                <li><a href="#work">Portfolio</a></li>
                <li><a href="#contact" class="big colored">Contact</a></li>
            </ul>
        </nav>
    </header>

    <nav>
        <button class="next">&gt;</button>
        <button class="prev">&lt;</button>
    </nav>    

    <div class="slideContainer">
        <ul>
            <li class="slide" data-name="home">
                <div class="content">
                    <h1>
                        <em class="colored">tristan</em>matthias
                    </h1>
                    
                    <h2>Web designer // developer</h2>
                    <a href="#work" class="big">My work</a>
                    <a href="#contact" class="big colored ">Get in touch</a>
                </div>
            </li>
        
            <li class="slide" data-name="work">
                <h1>Portfolio</h1>
                <ul id="behance"></ul>
            </li>

            <li class="slide" data-name="contact">
                <h1>Contact me</h1>
                <div class="flipContainer">
                    <div class="flipper">
                        <div class="front">
                            <form action="/contact">
                                <div class="formField">
                                    <input type="text"  name="name"    placeholder="Name">   
                                </div>
                                <div class="formField">
                                    <input type="email" name="email"   placeholder="Email">  
                                </div>
                                <div class="formField">    
                                    <input type="text"  name="subject" placeholder="Subject">
                                </div>
                                <div class="formField">
                                    <textarea name="message" placeholder="Message" maxlength="500" ></textarea>
                                </div>

                                <button type="submit" class="big colored">
                                    <span class="text">Go!</span> 
                                    <span class="loading"></span>
                                </button>
                            </form>
                        </div>
                        <div class="back">
                            <h2>Thank you :)</h2>
                            <button class="big colored">Return</button>
                        </div>
                    </div>
                </div>

            </li>
        </ul>
    </div>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/javascripts/vendor/jquery-validation/jquery.validate.js"></script>

<script>var BEHANCE_USER = "tristanmatthias";</script>
<script src="/javascripts/behance.js"></script>

<script>

    $(function() {
        var container = $(".slideContainer"),
            slide     = $(".slideContainer > ul")
            slides    = slide.children(),
            slideNum  = slides.length,
            next      = $("button.next"),
            prev      = $("button.prev");

        container
            .data("pos", 0)
            .css("width", slideNum * 100 + "%");
        slides.css("width", 100/slideNum + "%");

        prev.on("click", function() { 
            navigate("prev");
        });
        next.on("click", function() { 
            navigate("next");
        });

        
        if (window.location.hash) {
            navigateByName(window.location.hash.slice(1));
        } else {
            navigate(0);
        }

        window.onhashchange = function() {
            navigateByName(window.location.hash.slice(1));
        }

        function navigateByName(name) {
            var s = $(".slide[data-name = '" + name + "']");
            if (s.length) {
                navigate(s.index());
            }
        }

        function navigate(pageOrdir) {
            var pos;
            if ((typeof pageOrdir === "string") && ((pageOrdir === "next") || (pageOrdir === "prev"))) {
                var position = container.data("pos"),
                    pos = (pageOrdir === "next") ? position + 1 : position - 1;
            } else if (typeof pageOrdir === "number") {
                pos = pageOrdir;
            } else {
                return $.error("Incorrect value for navigation. Expected value 'next', 'prev' or Integer.");
            }


            (pos === 0) ? prev.hide() : prev.show();
            (pos === (slideNum -1)) ? next.hide() : next.show();
            
            var name = $(slides[pos]).data("name");
            window.location.hash = (name != "home") ? name : "";
            container.data("pos", pos);
            
            var nav = $("body > header nav").find("li").removeClass("active");
            $(nav[pos]).addClass("active");

            slide.css("marginLeft", -pos * (100/slideNum) + "%");

        };


        var f = $("form")

        // Reseting the message
        $.validator.messages.required = 
        $.validator.messages.minlength =
        $.validator.messages.email =  "!"

        f.validate({
        rules: {
            name: {required: true, minlength: 2},
            email: {
                required: true,
                email: true
            },
            subject: {
                required: true,
            }, 
            message: {
                required: true
            }
        },
        messages: "!",
        submitHandler: function(form) {
            var bText = f.find(".text"),
                bIcon = f.find(".loading");
            bText.hide();
            bIcon.css("display", "block");

            $.ajax({
                url: "/contact",
                data: f.serializeArray(),
                type: "post",
                success: function() {
                    bIcon.hide();
                    bText.show();
                    f.closest(".flipContainer").addClass("flipped");
                    f[0].reset();
                }
            });

            return false;
        }
    });





        $(".flipContainer .back button").on("click", function() {
            $(this).closest(".flipContainer").removeClass("flipped");
        });

    });
</script>

</body>
</html>